<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>数字猜谜游戏</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #game-container { max-width: 600px; margin: 0 auto; }
    #output { 
      height: 300px; 
      border: 1px solid #ccc; 
      padding: 10px; 
      margin: 10px 0; 
      overflow-y: auto; 
      white-space: pre-wrap;
    }
    #input-box { width: 80%; padding: 8px; }
    #submit-btn { padding: 8px 16px; margin-left: 10px; }
  </style>
</head>
<body>
  <div id="game-container">
    <h1>数字猜谜游戏</h1>
    <div id="output">欢迎来到数字猜谜游戏！
请猜一个四位不重复的数字（第一位不为0）。
</div>
    <input type="text" id="input-box" placeholder="输入四位数字">
    <button id="submit-btn">提交猜测</button>
  </div>

  <script>
    // 1. 生成随机四位不重复数字（和C++逻辑一致）
    let target = [];
    let used = new Array(10).fill(false);
    for (let i = 0; i < 4; i++) {
      let num;
      do {
        num = Math.floor(Math.random() * 10);
      } while (used[num] || (i === 0 && num === 0));
      used[num] = true;
      target.push(num);
    }

    let guessCount = 0;
    const output = document.getElementById('output');
    const inputBox = document.getElementById('input-box');
    const submitBtn = document.getElementById('submit-btn');

    // 2. 实时处理输入和输出
    function handleGuess() {
      const input = inputBox.value.trim();
      guessCount++;

      // 输入验证（和C++逻辑一致）
      if (input.length !== 4) {
        output.textContent += `第${guessCount}次猜测：输入错误！请输入四位数字。\n`;
        inputBox.value = '';
        output.scrollTop = output.scrollHeight;
        return;
      }

      let inputUsed = new Array(10).fill(false);
      let valid = true;
      for (let c of input) {
        if (isNaN(c) || inputUsed[Number(c)]) {
          valid = false;
          break;
        }
        inputUsed[Number(c)] = true;
      }
      if (!valid || input[0] === '0') {
        output.textContent += `第${guessCount}次猜测：输入错误！请输入四位不重复的数字，且第一位不为0。\n`;
        inputBox.value = '';
        output.scrollTop = output.scrollHeight;
        return;
      }

      // 计算A和B（和C++逻辑一致）
      let a = 0, b = 0;
      const guess = input.split('').map(Number);
      for (let i = 0; i < 4; i++) {
        if (guess[i] === target[i]) {
          a++;
        } else if (used[guess[i]]) {
          b++;
        }
      }

      // 实时输出结果
      output.textContent += `第${guessCount}次猜测：${input} → ${a}A${b}B\n`;
      if (a === 4) {
        output.textContent += `恭喜你！猜对了，总共猜了${guessCount}次。\n游戏结束，刷新页面重新开始。\n`;
        submitBtn.disabled = true;
        inputBox.disabled = true;
      }

      inputBox.value = '';
      output.scrollTop = output.scrollHeight; // 滚动到最新内容
    }

    // 3. 绑定事件（回车/点击都可提交）
    submitBtn.addEventListener('click', handleGuess);
    inputBox.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') handleGuess();
    });
  </script>
</body>
</html>